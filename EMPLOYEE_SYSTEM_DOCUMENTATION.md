# دليل نظام إدارة الموظفين

## نظرة عامة

تم بناء نظام إدارة موظفين متكامل مع نظام حوافز تلقائي ونظام أكواد للعملاء، مبني على **Nextbase** (Next.js + Supabase + TypeScript).

## المكونات الرئيسية

### 1. قاعدة البيانات (Database)

تم إنشاء 7 migrations جديدة في مجلد `supabase/migrations/`:

#### الجداول المنشأة:

1. **employee_types** - أنواع الموظفين
   - موظف كول سنتر (كود: 101)
   - موظف ريسبشن (كود: 201)
   - سائق (كود: 301)
   - مندوب (كود: 401)
   - فني صيانة (كود: 501)
   - مدير قسم فني (كود: 601)
   - مدير عام (كود: 701)

2. **employees** - بيانات الموظفين
   - معلومات الموظف الأساسية
   - الراتب الأساسي والراتب اليومي
   - ربط مع نوع الموظف

3. **customers** - بيانات العملاء
   - معلومات العميل
   - كود العميل الفريد (مثال: 101-0001)
   - حالة الحضور للشركة
   - ربط مع موظف الكول سنتر والريسبشن

4. **devices** - الأجهزة
   - معلومات الجهاز
   - حالة الصيانة (waiting, in_progress, completed, delivered)
   - ربط مع العميل والفني

5. **incentives** - الحوافز
   - أنواع الحوافز المختلفة
   - المبالغ والتواريخ
   - حالة الدفع

6. **attendance** - الحضور والانصراف
   - تسجيل الدخول والخروج
   - ساعات العمل الإضافية
   - أيام الإجازات

7. **work_schedules** - مواعيد العمل
   - جدول العمل الأسبوعي لكل موظف

8. **incentive_settings** - إعدادات الحوافز
   - مبالغ الحوافز القابلة للتعديل

9. **device_status_history** - تاريخ حالة الجهاز
   - تتبع جميع تغييرات حالة الجهاز

10. **holidays** - الإجازات الرسمية

### 2. نظام الحوافز التلقائي

#### أنواع الحوافز:

1. **customer_visit** - حافز حضور العميل (50 جنيه)
   - يُضاف تلقائياً لموظف الكول سنتر عند حضور العميل للشركة

2. **on_time_attendance** - حافز الحضور في الموعد (20 جنيه)
   - يُضاف عند تسجيل الدخول في الموعد (خلال 15 دقيقة من الموعد المحدد)

3. **holiday_work** - حافز العمل في يوم الإجازة (100 جنيه)
   - يُضاف تلقائياً عند العمل في يوم إجازة رسمية

4. **overtime** - حافز الساعة الإضافية (30 جنيه للساعة)
   - يُضاف عند العمل ساعة أو ساعتين بعد الموعد

5. **monthly_milestone** - حافز شهري (500 جنيه)
   - يُضاف عند إكمال 9999 عميل بشرط حضور 50% منهم

6. **customer_registration** - حافز تسجيل العميل (30 جنيه)
   - يُضاف لموظف الريسبشن عند تسجيل حضور العميل

### 3. نظام الأكواد

#### كود الموظف:
- **البنية**: `[بادئة نوع الموظف][رقم تسلسلي]`
- **مثال**: `1010001` (موظف كول سنتر رقم 1)

#### كود العميل:
- **البنية**: `[كود الموظف]-[رقم تسلسلي]`
- **مثال**: `1010001-0001` (أول عميل لموظف كول سنتر 1010001)
- **الفائدة**: تتبع من استقبل العميل وربط الحوافز تلقائياً

### 4. الواجهات (Pages)

تم إنشاء 3 واجهات رئيسية:

#### أ. لوحة موظف الكول سنتر (`/employee/call-center`)

**المميزات:**
- عرض الراتب اليومي + الحوافز المتراكمة في الوقت الفعلي
- تسجيل الحضور والانصراف
- نموذج تسجيل عميل جديد وإعطاء كود
- قائمة العملاء المسجلين مع حالة الحضور
- إحصائيات شاملة:
  - إجمالي العملاء
  - العملاء الذين حضروا
  - نسبة الحضور
  - الحوافز غير المدفوعة
- عرض حوافز اليوم مع التفاصيل

#### ب. لوحة موظف الريسبشن (`/employee/reception`)

**المميزات:**
- البحث عن العميل بالكود
- تسجيل حضور العميل (يُضيف حافز تلقائي)
- نموذج تسجيل جهاز جديد
- عرض الراتب اليومي + الحوافز
- عرض حوافز اليوم

#### ج. صفحة تتبع العميل (`/customer-tracking`)

**المميزات:**
- البحث بكود العميل
- عرض جميع الأجهزة المسجلة
- تفاصيل كل جهاز
- تاريخ حالة الجهاز مع الخطوات
- واجهة سهلة للعميل لمتابعة جهازه

### 5. Server Actions

تم إنشاء 4 ملفات server actions:

1. **employee-actions.ts**
   - إنشاء وتحديث الموظفين
   - الحصول على بيانات الموظف
   - تسجيل الحضور والانصراف
   - الحصول على الإحصائيات والإجمالي اليومي

2. **customer-actions.ts**
   - إنشاء عميل جديد
   - تسجيل حضور العميل
   - البحث عن العميل بالكود
   - الحصول على عملاء موظف معين
   - التحقق من الهدف الشهري

3. **device-actions.ts**
   - إنشاء جهاز جديد
   - تحديث حالة الجهاز
   - الحصول على أجهزة عميل أو فني
   - الحصول على تاريخ حالة الجهاز

4. **incentive-actions.ts**
   - الحصول على حوافز موظف
   - الحصول على حوافز اليوم
   - الحصول على الحوافز غير المدفوعة
   - تحديث إعدادات الحوافز
   - ملخص الحوافز

## كيفية الاستخدام

### للمطورين:

#### 1. إعداد قاعدة البيانات:

```bash
# تشغيل Supabase محلياً
supabase start

# تطبيق migrations
supabase db push
```

#### 2. تشغيل المشروع محلياً:

```bash
# تثبيت المكتبات
pnpm install

# تشغيل المشروع
pnpm dev
```

#### 3. الوصول للواجهات:

- لوحة الكول سنتر: `http://localhost:3000/employee/call-center`
- لوحة الريسبشن: `http://localhost:3000/employee/reception`
- تتبع العميل: `http://localhost:3000/customer-tracking`

### للمستخدمين:

#### موظف الكول سنتر:

1. سجل الحضور عند بدء العمل
2. أضف عملاء جدد وأعطهم أكوادهم
3. راقب حوافزك اليومية في الوقت الفعلي
4. سجل الانصراف عند انتهاء العمل

#### موظف الريسبشن:

1. ابحث عن العميل بالكود
2. سجل حضور العميل (يُضاف حافز تلقائي)
3. سجل جهاز العميل مع التفاصيل
4. راقب حوافزك اليومية

#### العميل:

1. احتفظ بالكود الذي أعطاك إياه موظف الكول سنتر
2. افتح صفحة التتبع وأدخل الكود
3. تابع حالة جهازك في أي وقت

## الأمان (Security)

تم تطبيق **Row Level Security (RLS)** على جميع الجداول:

- كل موظف يرى بياناته فقط
- المدراء يرون جميع البيانات
- العملاء يرون أجهزتهم فقط (عبر الكود)

## النشر (Deployment)

### النشر التلقائي على Vercel:

المشروع مربوط بـ Vercel ويتم النشر تلقائياً عند:
- Push إلى branch `main` على GitHub

### الرابط:
- **GitHub**: https://github.com/egyptofrance/modeer
- **Vercel**: https://vercel.com/naebaks-projects/management
- **الموقع المباشر**: https://modeer.vercel.app

## المميزات المستقبلية (Future Enhancements)

1. **تطبيق Android للعملاء**
   - تحويل صفحة التتبع إلى تطبيق Android
   - إشعارات فورية عند تغيير حالة الجهاز

2. **لوحة الفني**
   - عرض الأجهزة المعينة له
   - تحديث حالة الصيانة
   - إضافة ملاحظات فنية

3. **لوحة المدير**
   - تقارير شاملة
   - إدارة الموظفين والحوافز
   - تحليلات الأداء

4. **نظام الإشعارات**
   - إشعارات فورية للموظفين عند إضافة حافز
   - إشعارات للعملاء عند تغيير حالة الجهاز

5. **تقارير متقدمة**
   - تقارير يومية/أسبوعية/شهرية
   - تحليل أداء الموظفين
   - معدلات التحويل

## الدعم الفني

للمساعدة أو الاستفسارات:
- **Email**: egyptofrance@gmail.com
- **GitHub Issues**: https://github.com/egyptofrance/modeer/issues

## الترخيص

هذا المشروع مبني على Nextbase وهو متاح للاستخدام الشخصي والتجاري.

---

**تم التطوير بواسطة**: Manus AI Agent
**التاريخ**: نوفمبر 2025
**الإصدار**: 1.0.0
